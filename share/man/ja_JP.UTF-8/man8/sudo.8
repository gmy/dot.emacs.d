.\" Copyright (c) 1994-1996, 1998-2005, 2007-2009
.\" 	Todd C. Miller <Todd.Miller@courtesan.com>
.\" 
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\" 
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\" ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\" 
.\" Sponsored in part by the Defense Advanced Research Projects
.\" Agency (DARPA) and Air Force Research Laboratory, Air Force
.\" Materiel Command, USAF, under agreement number F39502-99-1-0512.
.\" 
.\" Japanese Version Copyright (c) 2000-2002 Yuichi SATO
.\"   and 2009 Yoichi Chonan
.\"         all rights reserved.
.\" Translated Sat Oct  7 14:39:18 JST 2000
.\"         by Yuichi SATO <ysato444@yahoo.co.jp>
.\" Updated & Modified Fri Dec  6 04:40:44 JST 2002 by Yuichi SATO
.\" New Translation (sudo-1.6.9p17) Fri Jan 23 10:31:17 JST 2009
.\"         by Yoichi Chonan <cyoichi@maple.ocn.ne.jp>
.\" Updated & Modified (sudo-1.7.2p1) Sat Nov 14 21:15:16 JST 2009
.\"         by Yoichi Chonan
.\"
.\" $Sudo: sudo.man.in,v 1.56 2009/06/29 13:36:42 millert Exp $
.\" Automatically generated by Pod::Man 2.16 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` 
.    ds C' 
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SUDO 8"
.TH SUDO 8 "June 15, 2009" "1.7.2p1" "MAINTENANCE COMMANDS"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "名前"
sudo, sudoedit \- コマンドを別のユーザとして実行する
.SH "書式"
.IX Header "SYNOPSIS"
\&\fBsudo\fR \fB\-h\fR | \fB\-K\fR | \fB\-k\fR | \fB\-L\fR | \fB\-V\fR
.PP
\&\fBsudo\fR \fB\-v\fR [\fB\-AknS\fR]
.\" [\fB\-a\fR\ \fIauth_type\fR]
[\fB\-p\fR\ \fIprompt\fR]
.PP
\&\fBsudo\fR \fB\-l[l]\fR [\fB\-AknS\fR]
.\" [\fB\-a\fR\ \fIauth_type\fR]
[\fB\-g\fR\ \fIgroupname\fR|\fI#gid\fR] [\fB\-p\fR\ \fIprompt\fR]
[\fB\-U\fR\ \fIusername\fR] [\fB\-u\fR\ \fIusername\fR|\fI#uid\fR] [\fIcommand\fR]
.PP
\&\fBsudo\fR [\fB\-AbEHnPS\fR]
.\" [\fB\-a\fR\ \fIauth_type\fR]
[\fB\-C\fR\ \fIfd\fR]
.\" [\fB\-c\fR\ \fIclass\fR|\fI\-\fR]
[\fB\-g\fR\ \fIgroupname\fR|\fI#gid\fR] [\fB\-p\fR\ \fIprompt\fR]
.\" [\fB\-r\fR\ \fIrole\fR] [\fB\-t\fR\ \fItype\fR]
[\fB\-u\fR\ \fIusername\fR|\fI#uid\fR]
[\fB\s-1VAR\s0\fR=\fIvalue\fR] [\fB\-i\fR\ |\ \fB\-s\fR] [\fIcommand\fR]
.PP
\&\fBsudoedit\fR [\fB\-AnS\fR]
.\" [\fB\-a\fR\ \fIauth_type\fR]
[\fB\-C\fR\ \fIfd\fR]
.\" [\fB\-c\fR\ \fIclass\fR|\fI\-\fR]
[\fB\-g\fR\ \fIgroupname\fR|\fI#gid\fR] [\fB\-p\fR\ \fIprompt\fR]
[\fB\-u\fR\ \fIusername\fR|\fI#uid\fR] file ...
.SH "説明"
.IX Header "DESCRIPTION"
\&\fBsudo\fR を使用すると、許可されたユーザが、スーパーユーザを始め
自分以外のユーザに変身して、コマンドを実行することが可能になる。
許可の範囲については、\fIsudoers\fR ファイルで指定する。実 uid と gid 、
実効 uid と gid は、変身の対象になるユーザの、passwd ファイルに
明記されているものと同一になるようにセットされる。所属するグループに
ついても (\fB-P\fR オプションが指定されていないかぎり)、group ファイルに
基づいて初期化される。\fBsudo\fR を起動するユーザが root だったり、
変身の対象になるユーザが \fBsudo\fR を起動するユーザと同一だったり
する場合は、パスワードは要求されない。それ以外の場合は、パスワードを
要求して、本人であることを証明するように求めるのが、\fBsudo\fR の
デフォルトの動作である (\s-1注意:\s0 デフォルトの設定では、
求められるのは \fBsudo\fR を実行するユーザのパスワードであって、
root のパスワードではない)。ユーザの認証がすむと、タイムスタンプが
更新され、ユーザはしばらくの間 (\fIsudoers\fR で設定が変更されて
いないかぎり \f(CW\*(C`5\*(C'\fR 分間) パスワードなしで \fBsudo\fR を
使用することができる。
.PP
\&\fBsudoedit\fR というコマンド名で起動するのは、\fBsudo\fR に \fB-e\fR 
オプション (下記参照) を付けて実行するのと同じである。
.PP
\&\fBsudo\fR は \fI/etc/sudoers\fR ファイルを参照して、誰に \fBsudo\fR を
使用する権限があるかを判断する。\fBsudo\fR に \fB-v\fR オプションを
付けて動かすと、ユーザはコマンドを実行せずに、タイムスタンプを
更新することができる。ユーザが \f(CW\*(C`5\*(C'\fR 分以内にパスワードを
入力しないと、パスワードプロンプトそのものも (\fIsudoers\fR で設定が
変更されていないかぎり)、タイムアウトする。
.PP
\&\fIsudoers\fR ファイルに名前の載っていないユーザが \fBsudo\fR を使って
コマンドを実行しようとすると、しかるべき権威者にメールが送付される。
誰にメールを送るかは、プログラムを configure するときに決めることが
できるが、\fIsudoers\fR ファイルで指定してもよい (デフォルトの宛先は 
\&\f(CW\*(C`root\*(C'\fR である)。\fBsudo\fR を使用する権限のない
ユーザが、\fB-l\fR や \fB-v\fR オプションを付けて \fBsudo\fR を
実行しようとしても、メールは送付されないことに注意してほしい。
これによって、自分が \fBsudo\fR を使用できるかどうか、ユーザが自分で
判断できるようになっているのである。
.PP
\&\fBsudo\fR が root によって実行されたとき、環境変数 
\&\f(CW\*(C`SUDO_USER\*(C'\fR がセットされていると、\fBsudo\fR は
実際のユーザが誰かを決めるのに、その変数の値を使用することになる。ユーザは
この動作を利用することで、すでにルート・シェルを呼び出しているときでも、
自分がそこからさらに \fBsudo\fR 経由で使用したコマンドのログを取ることが
できる。またこのことによって、\fBsudo\fR で実行したスクリプトや
プログラムから呼び出される場合でも、\fB-e\fR オプションが相変わらず
便利なものになっている。とは言え、こうした場合でも、\fIsudoers\fR の
参照は、やはり root に対してなされるのであって、
\&\f(CW\*(C`SUDO_USER\*(C'\fR が指定するユーザに対してではないことに
注意してほしい。
.PP
\&\fBsudo\fR は、実行の試みが成功した場合も失敗した場合も、そのことを 
(エラー内容とともに) \fIsyslog\fR\|(3) なり独自のログファイルなり、
あるいはその両方なりに書き出すことができる。デフォルトでは、\fBsudo\fR は 
\fIsyslog\fR\|(3) 経由でログを記録するが、この動作は configure 時に、
あるいは \&\fIsudoers\fR ファイルによって、変更可能である。
.SH "オプション"
.IX Header "OPTIONS"
\&\fBsudo\fR では以下のコマンドライン・オプションが使用できる。
.IP "\-A" 12
.IX Item "-A"
通常 \fBsudo\fR がパスワードを要求するとき、パスワードは現在使用している
ターミナルから読み込まれる。\fB\-A\fR (\fIaskpass\fR) を指定した場合は、
ヘルパー・プログラム (グラフィカルなものでもよい) が実行されて、ユーザの
パスワードを読み込み、それを標準出力に書き出す。
環境変数 \f(CW\*(C`SUDO_ASKPASS\*(C'\fR が設定されているときは、
それがヘルパー・プログラムのパスになる。それ以外の場合は、
\&\fIsudoers\fR\|(5) の \fIaskpass\fR オプションが指定している値が使用される。
.\" .IP "\-a \fItype\fR" 12
.\" .IX Item "-a type"
.\" The \fB\-a\fR (\fIauthentication type\fR) option causes \fBsudo\fR to use the
.\" specified authentication type when validating the user, as allowed
.\" by \fI/etc/login.conf\fR.  The system administrator may specify a list
.\" of sudo-specific authentication methods by adding an \*(L"auth-sudo\*(R"
.\" entry in \fI/etc/login.conf\fR.  This option is only available on systems
.\" that support \s-1BSD\s0 authentication.
.\" \&\fB\-a\fR (\fIauthentication type\fR) オプションを使うと、\fBsudo\fR は
.\" ユーザの認証に、指定したタイプの認証方法を使用するようになる。ただし、
.\" その認証のタイプは \fI/etc/login.conf\fR で有効になっていなければなら
.\" ない。システム管理者は \fI/etc/login.conf\fR に \*(L"auth-sudo\*(R" 
.\" 項目を追加することによって、\fBsudo\fR 専用の認証方法のリストを指定す
.\" ることができる。このオプションは \s-1BSD\s0 認証に対応したシステムでの
.\" み有効である。
.IP "\-b" 12
.IX Item "-b"
\&\fB\-b\fR (\fIbackground\fR) オプションを付けると、\fBsudo\fR は
指定されたコマンドをバックグラウンドで実行する。\fB-b\fR オプションを
使用すると、シェルのジョブ制御を使ってプロセスを操作できなくなるので
注意してほしい。
.IP "\-C \fIfd\fR" 12
.IX Item "-C fd"
通常 \fBsudo\fR は、標準入力、標準出力、標準エラーを除いて、オープンした
すべてのファイル・ディスクリプタをクローズする。これに対し、
\&\fB\-C\fR (\fIclose from\fR) オプションを使用すると、
標準エラーより番号の大きい (すなわち、ファイル・ディスクリプタ 3 以上の)
どのファイル・ディスクリプタからクローズして行くかを、ユーザが指定できる
ようになる。3 未満の値は許可されない。このオプションが使用できるのは、
管理者が \fIsudoers\fR\|(5) 中で \fIclosefrom_override\fR オプションを
有効にしたときだけである。
.\" .IP "\-c \fIclass\fR" 12
.\" .IX Item "-c class"
.\" The \fB\-c\fR (\fIclass\fR) option causes \fBsudo\fR to run the specified command
.\" with resources limited by the specified login class.  The \fIclass\fR
.\" argument can be either a class name as defined in \fI/etc/login.conf\fR,
.\" or a single '\-' character.  Specifying a \fIclass\fR of \f(CW\*(C`\-\*(C'\fR indicates
.\" that the command should be run restricted by the default login
.\" capabilities for the user the command is run as.  If the \fIclass\fR
.\" argument specifies an existing user class, the command must be run
.\" as root, or the \fBsudo\fR command must be run from a shell that is already
.\" root.  This option is only available on systems with \s-1BSD\s0 login classes.
.\" \&\fB\-c\fR (\fIclass\fR) オプションを付けると、その指定した
.\" login class のリソースの制限内で、\fBsudo\fR は指定されたコマンドを
.\" 実行する。\fB-c\fR の引き数 \fIclass\fR に使うことができるのは、
.\" \&\fI/etc/login.conf\fR で定義された class 名か、一個の '\-' 文字である。
.\" \&\fIclass\fR に \f(CW\*(C`\-\*(C'\fR を指定すると、コマンドは
.\" 実行されるとき、変身対象ユーザのデフォルトのログイン権限によって
.\" 制限されることになる。引き数 \fIclass\fR が実在する user class を
.\" 指している場合は、コマンドを root として実行するか、あるいはすでに root 
.\" になったシェルで \fBsudo\fR コマンドを実行するかしなければならない。 
.\" このオプションは、\s-1BSD\s0 login class が存在するシステムでのみ
.\" 有効である。
.IP "\-E" 12
.IX Item "-E"
\&\fB\-E\fR (\fIpreserve\fR \fIenvironment\fR) オプションは 
\&\fIsudoers\fR\|(5) ファイルの \fIenv_reset\fR オプションを無効にする。
これが使用できるのは、マッチするコマンドに \f(CW\*(C`SETENV\*(C'\fR タグが
付いているときか、
\&\fIsudoers\fR\|(5) で \fIsetenv\fR オプションがセットされているとき
だけである。
.IP "\-e" 12
.IX Item "-e"
\&\fB\-e\fR (\fIedit\fR) オプションを指定するのは、ユーザーがコマンドの
実行ではなく、一つ以上のファイルの編集を望んでいるということである。
\&\fIsudoers\fR ファイルの参照では、コマンドとして
文字列 \*(L"sudoedit\*(R" が使用される。
\&\fIsudoers\fR ファイルによってユーザに権限があることが認められると、
次のようなことが順番に行われる。
.RS 12
.IP "1." 4
編集対象のファイルのコピーをテンポラリファイルとして作成する。
テンポラリファイルのオーナーは \fBsudo\fR を起動したユーザである。
.IP "2." 4
環境変数 \f(CW\*(C`SUDO_EDITOR\*(C'\fR, \f(CW\*(C`VISUAL\*(C'\fR,
\&\f(CW\*(C`EDITOR\*(C'\fR のいづれかで指定されたエディタを起動して、
テンポラリファイルを編集する。
\&\f(CW\*(C`SUDO_EDITOR\*(C'\fR, \f(CW\*(C`VISUAL\*(C'\fR,
\&\f(CW\*(C`EDITOR\*(C'\fR のいづれも設定されていないときは、
\&\fIsudoers\fR ファイルの \fIeditor\fR 変数にリストされた
最初のプログラムが使用される。
.IP "3." 4
編集作業がすむと、テンポラリファイルをオリジナルのファイルに書き戻して、
テンポラリファイルを消去する。
.RE
.RS 12
.Sp
指定されたファイルが存在しない場合は作成する。ここで注意すべきは、
\&\fBsudo\fR によって実行されるコマンドの大部分と違って、
\&\fB\-e\fR でエディタが実行されるときは、\fBsudo\fR を起動した
ユーザの環境が、変更を受けずにそのまま使われるということである。
何らかの理由で \fBsudo\fR が編集した内容でファイルを更新できないときは、
ユーザに警告を発し、編集した内容をテンポラリファイルに保持することになる。
.RE
.IP "\-g \fIgroup\fR" 12
.IX Item "-g group"
通常 sudo はプライマリ・グループを、passwd データベースで
変身対象ユーザ (デフォルトでは root) のプライマリ・グループとして
指定されているグループに設定する。これに対し、\fB\-g\fR (\fIgroup\fR)
オプションを使用すると、\fBsudo\fR はプライマリ・グループを \fIgroup\fR に
設定して、指定のコマンドを実行することになる。グループ名の代わりに
\&\fIgid\fR を指定するときは、\fI#gid\fR という書き方をする。
多くのシェルでは、\fIgid\fR としてコマンドを実行するときは、'#' を
バックスラッシュ ('\e') でエスケープしなければならない。なお、
\&\fB\-u\fR オプションを同時に指定しない場合、コマンドは (root として
ではなく) \fBsudo\fR を起動するユーザの資格で実行されることになる。
いづれにしろ、プライマリ・グループが \fIgroup\fR に
設定されることに変わりはない。
(訳注: \fB\-g\fR オプションを使用するには、\fIsudoers\fR ファイルの
ユーザ設定で変身対象となるグループを設定しておく必要がある。詳細については、
\&\fIsudoers\fR\|(5) のマニュアルの該当個所を参照してほしい。)
.IP "\-H" 12
.IX Item "-H"
\&\fB\-H\fR (\fI\s-1HOME\s0\fR) オプションを指定すると、環境変数 
\&\f(CW\*(C`HOME\*(C'\fR が、変身の対象となるユーザ (デフォルトでは root) の、
\&\fIpasswd\fR\|(5) ファイルに明記されているホームディレクトリになる。
\&\fBsudo\fR はデフォルトでは、環境変数 \f(CW\*(C`HOME\*(C'\fR を
変更しない (\fIsudoers\fR\|(5) の \fIset_home\fR や \fIalways_set_home\fR 
フラグを参照すること)。
.IP "\-h" 12
.IX Item "-h"
\&\fB-h\fR (\fIhelp\fR) オプションを指定すると、\fBsudo\fR は使用法を
表示して終了する。
.IP "\-i [command]" 12
.IX Item "-i [command]"
\&\fB\-i\fR (\fIsimulate initial login\fR) オプションを指定すると、
\&\fIpasswd\fR\|(5) 中の変身対象ユーザのエントリで指定されているシェルが
ログイン・シェルとして実行される。すなわち、\f(CW\*(C`.profile\*(C'\fR や
\&\f(CW\*(C`.login\*(C'\fR といったログイン用のリソースファイルが
シェルによって読み込まれるわけだ。コマンドを指定すると、それがシェルに
渡されて、実行される。それ以外の場合は、対話的シェルが
実行されることになる。\fBsudo\fR は、シェルを実行する前に、変身対象ユーザの
ホームディレクトリに移動しようとする。また \fBsudo\fR は環境を初期化する。
変数 \fI\s-1DISPLAY\s0\fR と \fI\s-1TERM\s0\fR は変更しないが、 
\&\fI\s-1HOME\s0\fR, \fI\s-1SHELL\s0\fR, \fI\s-1USER\s0\fR, 
\&\fI\s-1LOGNAME\s0\fR, \fI\s-1PATH\s0\fR をセットし、さらに Linux や
\&\s-1AIX\s0 システムでは \fI/etc/environment\fR に書いてある環境変数も
設定する。それ以外の環境変数はすべて消去する。
.IP "\-K" 12
.IX Item "-K"
\&\fB\-K\fR (sure \fIkill\fR) オプションは \fB\-k\fR オプションに
似ているが、ユーザのタイムスタンプを完全に消去してしまうという点と、
コマンドや他のオプションと組み合わせて使用できないという点で異なっている。
このオプションはパスワードを要求しない。
.IP "\-k" 12
.IX Item "-k"
\&\fB\-k\fR (\fIkill\fR) オプションを単独で使うと、\fBsudo\fR は
タイムスタンプの日付を UNIX 紀元 (1970 年 1 月 1 日) に設定することで、
ユーザのタイムスタンプを失効させる。次回 \fBsudo\fR を実行するときには、
パスワードが要求されるようになるわけだ。このオプション自身はパスワードを
必要としない。なお、このオプションが追加されたのは、
ユーザが .logout ファイルで、パスワードなしでの \fBsudo\fR の実行を
無効にすることができるようにするためである。
.Sp
\&\fB\-k\fR オプションをコマンドや、パスワードを必要とするような
他のオプションと組み合わせて使用すると、\fBsudo\fR はユーザの
タイムスタンプ・ファイルを無視するようになる。その結果、\fBsudo\fR は
(\fIsudoers\fR の設定でパスワードを要求するようになっているならば)
プロンプトを出してパスワードを求めるものの、
ユーザのタイムスタンプ・ファイルの日付を更新することはない。
.IP "\-L" 12
.IX Item "-L"
\&\fB\-L\fR (\fIlist\fR defaults) オプションは、\fIsudoers\fR ファイルの
\&\fIDefaults\fR 行で設定できるパラメーターを列挙し、それぞれについて
簡単に説明する。このオプションは \fIgrep\fR\|(1) と一緒に使うと、便利である。
.IP "\-l[l] [\fIcommand\fR]" 12
.IX Item "-l[l] [command]"
\&\fIcommand\fR を指定しない場合、\fB\-l\fR (\fIlist\fR) オプションは、
\&\fBsudo\fR を実行したユーザ (あるいは、\fB\-U\fR で指定したユーザ) が
現在ログインしているホストで許可されている (及び、禁じられている) コマンドを
列挙する。\fIcommand\fR を指定した場合は、\fIsudoers\fR で許可されて
いるコマンドならば、その絶対パスを表示する (訳注: sudo-1.7.2 では、
\&\fIsudoers\fR でコマンドの引き数を明示的に指定している場合は、
コマンドラインからも \fB\-l\fR とコマンドに続けて、引き数まで正しく
指定しなければならない)。 
指定したコマンドが許可されていない場合は、\fBsudo\fR が
返り値 1 で終了する。\fB\-l\fR オプションに \fBl\fR 引数を付けた場合や
(すなわち \fB\-ll\fR)、\fB\-l\fR を複数回指定した場合は、長い方の
リスト形式が使用される。
.IP "\-n" 12
.IX Item "-n"
\&\fB\-n\fR (\fInon-interactive\fR) オプションがあると、\fBsudo\fR は 
ユーザにパスワードを要求するプロンプトを出さない。実行するコマンドに
パスワードが必要な場合、\fBsudo\fR はエラーメッセージを表示して、
終了する。
.IP "\-P" 12
.IX Item "-P"
\&\fB\-P\fR (\fIpreserve\fR \fIgroup vector\fR) オプションを指定すると、
\&\fBsudo\fR は、\fBsudo\fR を実行するユーザが所属するグループのリストを、
変更せずにそのまま使用する。 デフォルトでは、\fBsudo\fR は
所属グループの初期値として、変身対象となるユーザが所属するグループのリストを
設定するのだ。とは言え、実 gid や 実効 gid が変身対象ユーザと
同一になるようにセットされる点には、変わりがない。
.IP "\-p \fIprompt\fR" 12
.IX Item "-p prompt"
\&\fB\-p\fR (\fIprompt\fR) オプションを使うと、デフォルトのパスワード
プロンプトを変更して、好きな文句にすることができる。以下のパーセント 
(`\f(CW\*(C`%\*(C'\fR') エスケープが使用できる。
.RS 12
.ie n .IP "%H" 4
.el .IP "\f(CW%H\fR" 4
.IX Item "%H"
ドメイン名を含むローカルホスト名に展開される (マシンのホスト名が
完全修飾名であるか、\fIsudoers\fR ファイルで \fIfqdn\fR オプションが
セットされている場合に有効)
.ie n .IP "%h" 4
.el .IP "\f(CW%h\fR" 4
.IX Item "%h"
ドメイン名なしのローカルホスト名に展開
.ie n .IP "%p" 4
.el .IP "\f(CW%p\fR" 4
.IX Item "%p"
パスワードを要求されるユーザ名に展開 (\fIsudoers\fR ファイルのフラグ 
\&\fIrootpw\fR、\fItargetpw\fR、\fIrunaspw\fR を尊重する)
.ie n .IP "%U" 4
.el .IP "\f(CW%U\fR" 4
.IX Item "%U"
変身対象になる (デフォルトでは root) ユーザのログイン名に展開される
.ie n .IP "%u" 4
.el .IP "\f(CW%u\fR" 4
.IX Item "%u"
\&\fBsudo\fR を起動するユーザのログイン名に展開される
.ie n .IP "\*(C`%%\*(C'" 4
.el .IP "\f(CW\*(C`%%\*(C'\fR" 4
.IX Item "%%"
連続した二つの \f(CW\*(C`%\*(C'\fR は、一個の \f(CW\*(C`%\*(C'\fR 文字
そのものを意味する
.RE
.RS 12
.Sp
\&\fB\-p\fR で指定したプロンプトが、\s-1PAM\s0 をサポートしている
システムにおいてシステムのパスワードプロンプトを上書きするのは、
\&\fIsudoers\fR で \fIpassprompt_override\fR が有効になっている場合である
(訳注: \fIsudoers\fR\|(5) の passprompt_override の項も参照してほしい)。
.RE
.\" .IP "\-r \fIrole\fR" 12
.\" .IX Item "-r role"
.\" The \fB\-r\fR (\fIrole\fR) option causes the new (SELinux) security context to 
.\" have the role specified by \fIrole\fR.
.\" \&\fB\-r\fR (\fIrole\fR) オプションを使うと、(SELinux の) 新しいセキュ
.\" リティ・コンテキストが \fIrole\fR で指定されたロールを持つようになる。
.IP "\-S" 12
.IX Item "-S"
\&\fB\-S\fR (\fIstdin\fR) オプションを指定すると、\fBsudo\fR はパスワー
ドをターミナルデバイスからではなく、標準入力から読み込む。
.IP "\-s [command]" 12
.IX Item "-s [command]"
\&\fB\-s\fR (\fIshell\fR) は、環境変数 \fI\s-1SHELL\s0\fR が設定されていれば、
そのシェルを、さもなければ、\fIpasswd\fR\|(5) で指定されているシェルを
実行する。コマンドが指定された場合は、それをシェルに渡して実行させる。
コマンドが指定されていなければ、対話的シェルを開く。
.\" .IP "\-t \fItype\fR" 12
.\" .IX Item "-t type"
.\" The \fB\-t\fR (\fItype\fR) option causes the new (SELinux) security context to 
.\" have the type specified by \fItype\fR.  If no type is specified, the default
.\" type is derived from the specified role.
.\" \&\fB\-t\fR (\fItype\fR) オプションを使用すると、(SELinux の) 新しい 
.\" セキュリティ・コンテキストが \fItype\fR で指定されたタイプを持つように
.\" なる。type が指定されない場合は、デフォルトのタイプが、指定された role 
.\" から導き出される。
.IP "\-U \fIuser\fR" 12
.IX Item "-U user"
\&\fB\-U\fR (\fIother user\fR) オプションは、\fB\-l\fR と組み合わせて
使用し、誰の権限の一覧を表示するかを指定する。root のほかには、
現在のホストでコマンドに \f(CW\*(C`ALL\*(C'\fR を許されているユーザのみが
このオプションを使用できる。
.IP "\-u \fIuser\fR" 12
.IX Item "-u user"
\&\fB\-u\fR (\fIuser\fR) オプションを指定すると、\fBsudo\fR は 
\&\fIroot\fR 以外のユーザとして指定されたコマンドを実行する。
ユーザ名の代わりに \fIuid\fR を指定するときは、\fI#uid\fR という
書き方をする。多くのシェルでは、\fIuid\fR の資格でコマンドを
実行するときは、'#' をバックスラッシュ ('\e') でエスケープしなければ
ならない。\fIsudoers\fR ファイルの Defaults 行で \fItargetpw\fR オプションが
設定されているときは (\fIsudoers\fR\|(5) 参照)、パスワード・データベースに
記載されていない uid ではコマンドを実行できないことに注意してほしい。
.IP "\-V" 12
.IX Item "-V"
\&\fB\-V\fR (\fIversion\fR) オプションを指定すると、\fBsudo\fR は
バージョンナンバーを表示して、終了する。\fBsudo \-V\fR を実行するユーザが 
root だった場合は、\fBsudo\fR がコンパイルされたときのデフォルト値のリストを、
マシンのローカル IP アドレスとともに表示する。
.IP "\-v" 12
.IX Item "-v"
\&\fB\-v\fR (\fIvalidate\fR) オプションを指定すると、\fBsudo\fR はユーザの
タイムスタンプを更新する。このとき、もし必要なら、パスワードの入力を促す。
このオプションによって \fBsudo\fR のタイムアウト時間がもう
\&\f(CW\*(C`5\*(C'\fR 分間 (あるいは、何分であれ、\fIsudoers\fR で
設定されたタイムアウト時間) 伸びるが、このオプションがコマンドを実行する
ことはない。
.IP "\-\-" 12
\&\fB\-\-\fR オプションがあると、\fBsudo\fR はそこでコマンドライン引き数の
処理をやめる。これは \fB\-s\fR オプションと組み合わせて使うと、
大変便利である。
.PP
さらに、コマンドのためにセットしたい環境変数も、
\&\fB\s-1VAR\s0\fR=\fIvalue\fR、たとえば 
\&\fB\s-1LD_LIBRARY_PATH\s0\fR=\fI/usr/local/pkg/lib\fR といった形で
コマンドラインから渡すことができる。コマンドラインから渡される変数は、
通常の環境変数と同じ制限の対象になるが、一つだけ重要な違いがある。
\&\fIsudoers\fR ファイルで \fIsetenv\fR オプションが設定されているか、
実行されるコマンドに \f(CW\*(C`SETENV\*(C'\fR タグがついているか、
あるいは、マッチするコマンドが \f(CW\*(C`ALL\*(C'\fR である場合は、
ユーザがほかの状況でなら禁じられているような変数をセットすることが
できるのだ。詳細については \fIsudoers\fR\|(5) を参照してほしい。
.SH "返り値"
.IX Header "RETURN VALUES"
プログラムの実行に成功した場合、\fBsudo\fR が返す終了ステータスは、
実行したプログラムの終了ステータスそのものである。
.PP
そうでない場合、設定やパーミッションに問題があったり、\fBsudo\fR が
指定されたコマンドを実行できなかったりしたときは、\fBsudo\fR は
返り値 1 で終了する。後者の場合は、エラーメッセージが標準エラーに
表示される。また、 \fBsudo\fR がユーザの \f(CW\*(C`PATH\*(C'\fR にある
一つ以上のエントリを \fIstat\fR\|(2) できなかったときも、エラーが
標準エラーに出力される (ただし、そのディレクトリが存在しなかったり、
実際にはディレクトリでなかった場合は、そのエントリは無視され、エラーは
表示されない)。そうしたことは、正常な環境では起きるはずのないことである。
\&\fIstat\fR\|(2) が \*(L"permission denied\*(R" を返す理由で
一番よくあるのは、ユーザーがオートマウントを使用していて、
\&\f(CW\*(C`PATH\*(C'\fR にあるディレクトリの一つが目下到達不可能なマシンに
ある場合だ。
.SH "セキュリティに関する注意点"
.IX Header "SECURITY NOTES"
\&\fBsudo\fR は外部のコマンドをできるだけ安全に実行しようとする。
.PP
環境変数を扱うにあたって、二つの異なる行き方がある。デフォルトでは、
\&\fIsudoers\fR の \fIenv_reset\fR オプションが有効になっている。
この場合は、最小限の環境でコマンドが実行されることになるが、その環境とは、
\&\f(CW\*(C`TERM\*(C'\fR, \f(CW\*(C`PATH\*(C'\fR,
\&\f(CW\*(C`HOME\*(C'\fR, \f(CW\*(C`SHELL\*(C'\fR,
\&\f(CW\*(C`LOGNAME\*(C'\fR, \f(CW\*(C`USER\*(C'\fR,
\&\f(CW\*(C`USERNAME\*(C'\fR、それに \fBsudo\fR という
呼び出し側のプロセスから来た変数で、\fIsudoers\fR の \fIenv_check\fR や 
\&\fIenv_keep\fR オプションによって許可されたものである。言わば、
環境変数のホワイトリストが存在することになるわけだ。
.PP
他方、\fIsudoers\fR ファイルで \fIenv_reset\fR オプションが無効に
なっている場合は、いかなる変数も、\fIenv_check\fR や \fIenv_delete\fR 
オプションで明示的に拒否されていないかぎり、呼び出し側のプロセスから
継承される。この場合、\fIenv_check\fR や \fIenv_delete\fR はブラックリストの
ように振る舞うわけだ。危険性のある環境変数のすべてをブラックリストに
入れることは不可能なので、\fIenv_reset\fR のデフォルトの動作を使用する方を
お勧めする。
.PP
どんな場合でも、\f(CW\*(C`()\*(C'\fR で始まる値を持つ環境変数は
除去されるが、それは \fBbash\fR の関数と解釈されかねないからだ。
\&\fBsudo\fR が許可、または拒否する環境変数のリストは、
\&\f(CW\*(C`sudo \-V\*(C'\fR を root として実行したときの出力中に表示される。
.PP
たいていのオペレーティングシステムのダイナミック・リンカは、
ダイナミック・リンキングを制御する働きのある環境変数を、\fBsudo\fR も
その一つである setuid プログラムの環境から除去するものだということに注意して
ほしい。オペレーティングシステムが何であるかにもよるが、そうした環境変数には、
\&\f(CW\*(C`_RLD*\*(C'\fR, \f(CW\*(C`DYLD_*\*(C'\fR,
\&\f(CW\*(C`LD_*\*(C'\fR, \f(CW\*(C`LDR_*\*(C'\fR,
\&\f(CW\*(C`LIBPATH\*(C'\fR, \f(CW\*(C`SHLIB_PATH\*(C'\fR などが
含まれるだろう。この種の変数は、\fBsudo\fR の実行が始まるよりも前に、
環境から除去される。それ故、\fBsudo\fR がそうした変数を保持することは
不可能である。
.PP
偽コマンドの実行 (command spoofing) を防止するため、\fBsudo\fR は
コマンドを捜してユーザの \s-1PATH\s0 を検索する際に、\*(L".\*(R" と "" 
(どちらもカレントディレクトリを意味する) を最後に調べる (そのどちらか、
あるいは両方が \s-1PATH\s0 中に存在すればだが)。とは言え、環境変数 
\&\f(CW\*(C`PATH\*(C'\fR そのものは変更されずに、そのまま \fBsudo\fR が
実行するプログラムに渡されることに注意してほしい。
.PP
\&\fBsudo\fR はタイムスタンプ・ディレクトリ (デフォルトでは 
\&\fI/var/run/sudo\fR) の所有者を調べて、所有者が root でなかったり、
root 以外のユーザにも書き込みが可能だったりした場合は、そのディレクトリの
中身を無視する。root 以外のユーザでも \fIchown\fR\|(2) を利用して
ファイルの所有者を変えられるシステムでは、タイムスタンプ・ディレクトリが 
(たとえば \fI/tmp\fR といった) 誰にでも書き込めるディレクトリにあると、
一般ユーザが、\fBsudo\fR を実行する前にタイムスタンプ・ディレクトリを
作成することが可能になる。もっとも、\fBsudo\fR はタイムスタンプ・
ディレクトリとその中身の、所有者とモードをチェックしているので、
起こりえる唯一の被害は、ファイルを「隠匿」する目的でそのディレクトリに
入れて置かれることぐらいだ。これはあまりありそうにないことだ。なぜなら、
タイムスタンプ・ディレクトリが root の所有になり、ほかのユーザによる
アクセスが禁じられてしまうと、ファイルをそこに置いたユーザは
それを回収できなくなるからである。この問題を回避したかったら、
誰でも書き込めるわけではないディレクトリ (たとえば \fI/var/adm/sudo\fR) を
タイムスタンプ用に使用するなり、適切な所有者 (root) と
パーミッション (0700) を持った \fI/var/run/sudo\fR をシステムの
スタートアップ・ファイルで作成するなりすればよい。
.PP
\&\fBsudo\fR はあまりにも未来に設定したタイムスタンプを認めない。タイ
ムスタンプが「現在時 + 2 * \f(CW\*(C`TIMEOUT\*(C'\fR」より新しい日時だっ
た場合、\fBsudo\fR はそれを無視し、ログに記録して警告を発する。このよ
うになっているのは、一般ユーザがファイルの所有者を変えられるシステムで、
ユーザがいい加減な日付を付けて勝手に自分のタイムスタンプを作れないよう
にするためである。
.PP
\&\fBsudo\fR は通常、自分が明示的に実行したコマンドしかログに
記録しないことに気を付けてほしい。
ユーザが \f(CW\*(C`sudo su\*(C'\fR とか \f(CW\*(C`sudo sh\*(C'\fR とか
いったコマンドを実行した場合、そのシェルから続いて実行されるコマンドは
記録されないし、\fBsudo\fR によるアクセス制御もそういったコマンドに
及ばないことになる。
シェル・エスケープを提供するコマンドについても (たいていのエディタが
それに含まれる) 同じことが言える。
それ故、ユーザに \fBsudo\fR 経由でコマンドの使用を許すときは、
気がつかないうちにそのコマンドがユーザに事実上ルート・シェルを
与えていないかを、念には念を入れて確認しなければならない。もっと詳しいことが
知りたかったら、\fIsudoers\fR\|(5) の「シェル・エスケープを防止する」の
セクションを御覧になってほしい。
.SH "環境変数"
.IX Header "ENVIRONMENT"
\&\fBsudo\fR は以下の環境変数を利用する。
.ie n .IP "\*(C`EDITOR\*(C'" 16
.el .IP "\f(CW\*(C`EDITOR\*(C'\fR" 16
.IX Item "EDITOR"
変数 \f(CW\*(C`SUDO_EDITOR\*(C'\fR や \f(CW\*(C`VISUAL\*(C'\fR が設定されて
いないとき、\fB\-e\fR (sudoedit) モードで使用するデフォルトのエディタ
.ie n .IP "\*(C`HOME\*(C'" 16
.el .IP "\f(CW\*(C`HOME\*(C'\fR" 16
.IX Item "HOME"
\&\fB\-i\fR や \fB\-H\fR モードでは (あるいは、sudo が configure され
たとき \-\-enable\-shell\-sets\-home オプションが与えられていれば)、
変身対象ユーザのホームディレクトリにセットされる
.ie n .IP "\*(C`PATH\*(C'" 16
.el .IP "\f(CW\*(C`PATH\*(C'\fR" 16
.IX Item "PATH"
sudoers の \fIsecure_path\fR オプションが設定されていれば、無難な値に
セットされる
.ie n .IP "\*(C`SHELL\*(C'" 16
.el .IP "\f(CW\*(C`SHELL\*(C'\fR" 16
.IX Item "SHELL"
\&\fB\-s\fR オプションで実行されるシェルを決めるのに使用する
.ie n .IP "\*(C`SUDO_ASKPASS\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_ASKPASS\*(C'\fR" 16
.IX Item "SUDO_ASKPASS"
ターミナルが利用できない場合や、\f(CW\*(C`\-A\*(C'\fR オプションが
指定されている場合に、パスワードを読み込むのに使用するヘルパープログラムの
パスを指定する
.ie n .IP "\*(C`SUDO_COMMAND\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_COMMAND\*(C'\fR" 16
.IX Item "SUDO_COMMAND"
sudo が実行するコマンドにセットされる
.ie n .IP "\*(C`SUDO_EDITOR\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_EDITOR\*(C'\fR" 16
.IX Item "SUDO_EDITOR"
\&\fB\-e\fR (sudoedit) モードで使用するデフォルトのエディタ
.ie n .IP "\*(C`SUDO_GID\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_GID\*(C'\fR" 16
.IX Item "SUDO_GID"
sudo を起動したユーザのグループ \s-1ID\s0 にセットされる
.ie n .IP "\*(C`SUDO_PROMPT\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_PROMPT\*(C'\fR" 16
.IX Item "SUDO_PROMPT"
デフォルトのパスワード・プロンプトとして使用する
.ie n .IP "\*(C`SUDO_PS1\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_PS1\*(C'\fR" 16
.IX Item "SUDO_PS1"
設定すると、実行されるプログラムの \f(CW\*(C`PS1\*(C'\fR がこの変数の値に
セットされる
.ie n .IP "\*(C`SUDO_UID\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_UID\*(C'\fR" 16
.IX Item "SUDO_UID"
sudo を起動したユーザのユーザ \s-1ID\s0 にセットされる
.ie n .IP "\*(C`SUDO_USER\*(C'" 16
.el .IP "\f(CW\*(C`SUDO_USER\*(C'\fR" 16
.IX Item "SUDO_USER"
sudo を起動したユーザのログイン名にセットされる
.ie n .IP "\*(C`USER\*(C'" 16
.el .IP "\f(CW\*(C`USER\*(C'\fR" 16
.IX Item "USER"
変身対象ユーザにセットされる (オプション \fB\-u\fR が指定されていなければ、
root になる)
.ie n .IP "\*(C`VISUAL\*(C'" 16
.el .IP "\f(CW\*(C`VISUAL\*(C'\fR" 16
.IX Item "VISUAL"
変数 \f(CW\*(C`SUDO_EDITOR\*(C'\fR が設定されていない場合に、
\&\fB\-e\fR (sudoedit) モードで使用するデフォルトのエディタ
.SH "ファイル"
.IX Header "FILES"
.ie n .IP "\fI/etc/sudoers\fR" 24
.el .IP "\fI/etc/sudoers\fR" 24
.IX Item "/etc/sudoers"
誰が何を実行できるかのリスト
.ie n .IP "\fI/var/run/sudo\fR" 24
.el .IP "\fI/var/run/sudo\fR" 24
.IX Item "/var/run/sudo"
タイムスタンプが存在するディレクトリ
.IP "\fI/etc/environment\fR" 24
.IX Item "/etc/environment"
Linux や \s-1AIX\s0 で \fB\-i\fR モードを使うときの初期環境
.SH "用例"
.IX Header "EXAMPLES"
注意: 以下の例は、\fIsudoers\fR\|(5) に適切な記載があることを前提にして
いる。
.PP
読み取り不可のディレクトリのファイル一覧を取得する。
.PP
.Vb 1
\& $ sudo ls /usr/local/protected
.Ve
.PP
ユーザ yaz のホームディレクトリのファイル一覧を取得したいのだが、
~yaz を含むファイルシステムが別のマシンにあって、root で
アクセスできるようにエクスポートされていない場合。
.PP
.Vb 1
\& $ sudo \-u yaz ls ~yaz
.Ve
.PP
ユーザ www として \fIindex.html\fR ファイルを編集する。
.PP
.Vb 1
\& $ sudo \-u www vi ~www/htdocs/index.html
.Ve
.PP
root と adm グループのユーザだけがアクセスできるシステムログを閲覧する。
.PP
.Vb 1
\& $ sudo \-g adm view /var/log/syslog
.Ve
.PP
jim に変身してエディタを実行する。プライマリグループには別のグループを
指定する。
.PP
.Vb 1
\& $ sudo \-u jim \-g audio vi ~jim/sound.txt
.Ve
.PP
マシンをリブートする。
.PP
.Vb 1
\& $ sudo shutdown \-r +15 "quick reboot"
.Ve
.PP
/home パーティションに存在するディレクトリのディスク使用量リストを作成
する。\&\f(CW\*(C`cd\*(C'\fR やファイル・リダイレクションがきちんと動
作するように、コマンドをサブシェルで実行していることに注目してほしい。
.PP
.Vb 1
\& $ sudo sh \-c "cd /home ; du \-s * | sort \-rn > USAGE"
.Ve
.SH "関連項目"
.IX Header "SEE ALSO"
\&\fIgrep\fR\|(1), \fIsu\fR\|(1), \fIstat\fR\|(2),
.\" \&\fIlogin_cap\fR\|(3),
\&\fIpasswd\fR\|(5), \fIsudoers\fR\|(5), \fIvisudo\fR\|(8)
.SH "作者"
.IX Header "AUTHORS"
多数の人々が長年に渡って \fBsudo\fR の製作に取り組んできた。当バージョ
ンは主として次の者が書いたコードからできている。
.PP
.Vb 1
\&        Todd C. Miller
.Ve
.PP
\&\fBsudo\fR の簡単な履歴については、配布物中の \s-1HISTORY\s0 ファイルか、
http://www.sudo.ws/sudo/history.html を御覧いただきたい。
.SH "警告"
.IX Header "CAVEATS"
ユーザが \fBsudo\fR 経由で任意のコマンドの実行を許されているならば、
そのユーザがルート・シェルを獲得するのを防止する簡単な方法はない。
また、(エディタを含む) 多くのプログラムが、シェル・エスケープを通して
ユーザがコマンドを実行できるようにしており、この方法でユーザは \fBsudo\fR の
チェックを回避することができる。とは言え、たいていのシステムでは、
\&\fBsudo\fR の \fInoexec\fR 機能を用いてシェル・エスケープを阻止する
ことが可能だ。詳細については、
\&\fIsudoers\fR\|(5) のマニュアルを参照してほしい。
.PP
下記のように sudo を通して直接 \f(CW\*(C`cd\*(C'\fR コマンドを実行して
も意味がない。
.PP
.Vb 1
\& $ sudo cd /usr/local/protected
.Ve
.PP
なぜなら、コマンドが終了したとき、その親プロセス (あなたのシェルだ) は
相変わらず元の状態のままだからだ。より詳しく知りたかったら、「用例」セ
クションを御覧になってほしい。
.PP
もし \fIsudoers\fR ファイルでユーザに許可するコマンドが 
\&\f(CW\*(C`ALL\*(C'\fR になっているならば、ユーザ設定でどんな
項目に '!'  を付けようとも、ユーザが自分でプログラムを作って、
ルート・シェルを獲得するのを防ぐすべはまったくない。
.PP
\&\fBsudo\fR を介してシェルスクリプトを実行すると、ある種のオペレーティ
ングシステムで setuid シェルスクリプトを危険なものにしているのと同一の
カーネルのバグが表面化するおそれがある (使用している \s-1OS\s0 に 
/dev/fd/ ディレクトリがあれば、setuid シェルスクリプトはたいてい安全で
ある)。
.SH "バグ"
.IX Header "BUGS"
\&\fBsudo\fR にバクを発見したと思ったら、下記のページにアクセスして、
バグレポートを提出していただきたい。
.br
http://www.sudo.ws/sudo/bugs/
.SH "サポート"
.IX Header "SUPPORT"
ある程度の無料サポートが sudo-users メーリングリストを通して利用できる。
購読やアーカイブの検索には下記 URL を御覧になること。
.br
http://www.sudo.ws/mailman/listinfo/sudo\-users
.SH "免責"
.IX Header "DISCLAIMER"
\&\fBsudo\fR は「現状のまま」提供される。明示的な、あるいは黙示的な
いかなる保証も、商品性や特定目的への適合性についての黙示的な保証を含め、
またそれのみに止まらず、これを否認する。詳細な全文については、
\&\fBsudo\fR と一緒に配布されている \s-1LICENSE\s0 ファイルや
下記 Web ページを御覧いただきたい。
.br
http://www.sudo.ws/sudo/license.html
