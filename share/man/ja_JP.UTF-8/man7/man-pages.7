.\" (C) Copyright 1992-1999 Rickard E. Faith and David A. Wheeler
.\" (faith@cs.unc.edu and dwheeler@ida.org)
.\" and (C) Copyright 2007 Michael Kerrisk <mtk.manpages@gmail.com>
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one.
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" 2007-05-30 created by mtk, using text from old man.7 plus
.\" rewrites and additional text.
.\"
.\" Japanese Version Copyright (c) 2007  Akihiro MOTOKI
.\"         all rights reserved.
.\" Translated 2007-06-13, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>, LDP v2.54
.\" Updated 2007-07-04, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>, LDP v2.59
.\" Updated 2007-09-03, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>, LDP v2.64
.\" Updated 2008-08-09, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>, LDP v3.05
.\" 
.TH MAN-PAGES 7 2008-10-28 "Linux" "Linux Programmer's Manual"
.SH 名前
man-pages \- Linux の man ページを書く際の決まり事
.SH 書式
.B man
.RI [ section ]
.I title
.SH 説明
このページでは、
Linux \fIman-pages\fP プロジェクトのマニュアルページを書く際に
従うべき決まり事について説明する。
Linux \fIman-pages\fP は Linux のマニュアルページの
セクション 2, 3, 4, 5, 7 から構成されている。
このページで説明されている決まり事は、他のプロジェクトの
マニュアルページを書く作者にも役立つことだろう。
.SS マニュアルページのセクション
.PP
マニュアルのセクションは、習慣的に以下のような定義が用いられている:
.TP 10
.B 1 コマンド (プログラム)
シェルの中からユーザが実行できるコマンド。
.TP
.B 2 システムコール
カーネルが処理しなければならない関数。
.TP
.B 3 ライブラリコール
.I libc
の関数の大部分。
.TP
.B 4 スペシャルファイル (デバイス)
.I /dev
以下にあるファイル。
.TP
.B 5 ファイルのフォーマットと規約
.I /etc/passwd
などの人が読めるファイルのフォーマット。
.TP
.B 6 ゲーム
.TP
.B 7 約束事その他
様々な事柄の概要、慣習、プロトコル、文字集合の規格、その他雑多なこと。
.TP
.B 8 システム管理コマンド
.BR mount (8)
のような root のみが実行可能なコマンド。
.\" .TP
.\" .B 9 カーネルルーチン
.\" このマニュアルセクションは廃止された。
.\" かつてはここに Linux カーネルのドキュメントを置くのが良いことだと
.\" 考えられていた。しかし、文書化されたものは非常に少なく、
.\" またそれらもすでに古いものとなってしまった。
.\" カーネル開発者にとって、もっとよい情報源が他にあるだろう。
.SS マクロパッケージ
新しいマニュアルページは
.BR man (7)
で説明されている
.B groff an.tmac
パッケージを使って記述すべきである。
この方針は一貫性の確保が主な理由である。既存の Linux のマニュアルページ
の圧倒的多数がこれらのマクロを使って記述されている。
.SS ソースファイルの配置に関する決まり事
マニュアルページのソースコードの 1行の長さは
可能な限り 75文字を越えないようにしてほしい。
こうすることで、パッチをメール本文に載せて送る場合に、
メールクライアントによる行折り返しを回避することができる。

新しい文は行頭から開始する。
これにより、パッチの内容を確認しやすくなる。
パッチは文単位であることが多いからである。
.SS タイトル行
man ページの最初の行は \fBTH\fP コマンドにすべきである。
.RS
.sp
.B \&.TH
.I "title section date source manual"
.sp
.RE
個々の説明:
.RS
.TP 10
.I title
man ページのタイトル。全部大文字で記載する (例:
.IR MAN-PAGES )。
.TP
.I section
man ページが属するセクション番号 (例:
.IR 7 )。
.TP
.I date
最新のリビジョンの日付\(emman ページに変更を加えたときには
必ずこれを変更すること。
これが最も一般的なバージョン管理方法である。
日付は YYYY-MM-DD の形式で記載すべきである。
.TP
.I source
コマンド、関数、システムコールの出自。

数少ないセクション 1 と 8 のページの場合、おそらく単に
.I GNU
とだけ書くことが多いだろう。

システムコールの場合、単に
.I "Linux"
とだけ書く。
(以前の慣習では、マニュアルページを記載した/内容を確認したカーネルの
バージョン番号を記載していた。しかし、バージョン番号が実際の内容と
一致していることはなく、そのためバージョン番号がないよりも
おそらく悪い形になっていた。
今後は、バージョン番号を含めるのは避けること。)

glibc のライブラリコールや
その他の一般的な GNU ライブラリのライブラリコールの場合、
単に
.IR "GNU C Library" ", " GNU
と書くか、空の文字列を使う。

セクション 4 のページでは
.I "Linux"
を使う。

よくわからない場合は、
.I Linux
とか
.I GNU
と書いておく。
.TP
.I manual
マニュアルのタイトル (例:
\fIman-pages\fP パッケージのセクション 2 および 3 のページの場合には、
.I "Linux Programmer's Manual"
を使うこと)。
.RE
.SS マニュアルページのセクション
昔から使われてきたセクション名を以下のリストに示す。
これらを使うと良いだろう。
一般的に、マニュアルページは、少なくとも
.B 色つき
のセクションを持つのが望ましい。
新しくマニュアルページを作成する際には、だいたい以下のリストに示した
順序でセクションを配置するようにしてもらいたい。
.in +0.5i
.nf

\fB名前\fP
\fB書式\fP
設定               [通常はセクション 4 のみ]
\fB説明\fP
オプション         [通常はセクション 1, 8 のみ]
終了ステータス     [通常はセクション 1, 8 のみ]
返り値             [通常はセクション 2, 3 のみ]
.\" May 07: Few current man pages have an ERROR HANDLING section,,,
.\" エラー処理
エラー             [たいていはセクション 2, 3 のみ]
.\" May 07: Almost no current man pages have a USAGE section,,,
.\" 利用法
.\" 診断メッセージ
.\" May 07: Almost no current man pages have a SECURITY section,,,
.\" セキュリティ
環境変数
ファイル
バージョン         [通常はセクション 2, 3 のみ]
準拠
注意/備考
バグ
例
.\" 著者 セクションは非推奨である
.\" 著者
\fB関連項目\fP

.fi
.in
「伝統的に使われてきた見出しが使える場合には、それを使ってほしい。」
この種の一貫性を保つことで、情報を理解しやすくなるからである。
どうしても必要な場合には、理解しやすくなるように独自の見出しを
作ってもよい (特にセクション 4 や 5 のページではこうした方が
わかりやすくなる)。ただし、そうする前に、伝統的な見出しを使い、
そのセクション内にサブセクション (\fI.SS\fP) を設けることで
対応できないか考えてほしい。

以下のリストでは、上記のセクションのそれぞれの内容について
詳しく説明する。
.TP 14
.B 名前 (NAME)
そのマニュアルページの名前。
\fB.SH NAME\fP コマンドの行が従うべき大事な点については
.BR man (7)
を参照してほしい。
.TP
.B 書式 (SYNOPSIS)
コマンドや関数のインターフェースを簡潔に記述する。
コマンドに対しては、コマンドや引き数 (オプション) の文法を書く。
そのまま書くテキストにはボールド体を用い、置き換える引き数には
イタリック体を用いる。省略可能なオプションはブラケット ([]) で囲い、
選択肢は縦棒 (|) で区切り、繰り返しには省略符号 (...) を書く。
関数に対しては、必要なデータ宣言や
.B #include
指定を書き、関数宣言を続ける。

ヘッダファイルから関数 (や変数) の定義を得るために
機能検査マクロ (feature test macro) を定義しなければならない場合、
書式 (SYNOPSIS) に必要な機能検査マクロを記載すべきである。
機能検査マクロについては
.BR feature_test_macros (7)
で説明されている。
.\" FIXME . Say something here about compiler options
.TP
.B CONFIGURATION
デバイスの設定詳細。
通常、このセクションは 4 章のマニュアルページでのみ登場する。
.TP
.B 説明 (DESCRIPTION)
プログラム・関数・フォーマットの動作・目的を説明する。
ファイルや標準入力をどのように処理し、標準出力や標準エラー出力を
どのように生成するかといったことについて述べる。
内部動作や実装の詳細については省略する
(ただしそれが動作の理解にどうしても必要なら別)。
通常の場合について記述する。
プログラムのコマンドライン・オプションの説明には、
.B オプション
のセクションを用いる。
.\" 入力にある種の文法があったり、複雑なサブコマンドがある場合は、
.\" それらは
.\" .B 利用法
.\" のセクションに分離することを考えるとよい
.\" .RB ( 説明
.\" のセクションには概要だけを置くようにする)。
.TP
.B オプション (OPTIONS)
プログラムが受け付けるコマンドライン・オプションと、
その場合プログラムの振舞いがどう変わるかを説明する。
このセクションはセクション 1 と 8 のマニュアルページにだけ登場すべきである。
.\" .TP
.\" .B 利用法 (USAGE)
.\" コマンドなどが実装している副言語 (sublanguage) の文法を記述する。
.TP
.B 終了ステータス (EXIT STATUS)
プログラムの終了ステータスの値と、それらの値に対応する状況を列挙する。
このセクションはセクション 1 と 8 のマニュアルページにだけ登場すべきである。
.TP
.B 返り値 (RETURN VALUE)
セクション 2 と 3 のページの場合、このセクションに
ライブラリルーチンが呼び出し元に返す値のリストを記載する。
それらの値が返された場合の状態に対する説明も書く。
.TP
.B エラー (ERRORS)
セクション 2 と 3 のマニュアルページでは、
エラーが発生した場合に
.I errno
に設定される可能性がある値のリストを記載する。
リストには、エラーの値とエラーの原因についての情報を書く。
「エラーリストはアルファベット順にすべきである。」
.TP
.B 環境変数 (ENVIRONMENT)
プログラムや関数に影響する環境変数をリストし、それらの効果を書く。
.TP
.B ファイル (FILES)
プログラムや関数が用いるファイルを列記する。
例えば、設定ファイル、起動ファイル、プログラムが直接操作するファイルなどである。
これらのファイルのファイル名はフルパスで記載し、
ディレクトリの部分はユーザーの好みに合わせて
インストール処理で変更できるようにする。
多くのプログラムではデフォルトのインストール先は
.I /usr/local
である。したがってベースとなるマニュアルページでも
.I /usr/local
が使われていることが多いだろう。
.\" May 07: Almost no current man pages have a DIAGNOSTICS section;
.\"         "RETURN VALUE" or "EXIT STATUS" is preferred.
.\" .TP
.\" .B 診断メッセージ (DIAGNOSTICS)
.\" ごく一般的なエラーメッセージの概要と、
.\" それらをどう扱うかについて述べる。プログラムの実行時に現れる
.\" システムエラーメッセージや致命的シグナルを全部説明する必要はない。
.\" ただしそれらがプログラムに対して
.\" 何らかの特殊な意味を持っている場合は別である。
.\"
.\" May 07: Almost no current man pages have a SECURITY section.
.\".TP
.\" .B セキュリティ (SECURITY)
.\" セキュリティ関連の話題・問題について述べる。
.\" 避けるべき設定や環境・セキュリティ上の問題を引き起こすコマンド
.\" などについて警告する。それらが明らかでない場合には、これは特に重要である。
.\" セキュリティに関する話題は、必ずしも独立したセクションにする必要はない。
.\" もし理解しやすければ、セキュリティの情報は他のセクション
.\" (例えば
.\" .B 説明
.\" や
.\" .B 利用法
.\" など) に書いてもよい。
.\" しかし、セキュリティの情報はどこかには書いておいてほしい!
.TP
.B バージョン (VERSIONS)
システムコールやライブラリ関数が登場したり、動作の重要な変更が行われた、
Linux カーネルや glibc のバージョンについての簡潔な概要。
一般に、全ての新しいインターフェイスは、マニュアルページに
「バージョン」の節を設けるべきである。
残念なことに、多くの既存のマニュアルページにこの情報は含まれていない
(これらのページが書かれた時点ではそのようなポリシーはなかったからである)。
これを改善するパッチは歓迎されるが、
新しいコードを書くプログラマの観点からすれば、
おそらくこの情報が重要になるのは、
Linux 2.4 以降で追加されたカーネルインターフェイス (カーネル 2.2 からの変更) と
glibc バージョン 2.1 以降で追加されたライブラリ関数 (glibc 2.0 からの変更)
についてのみであろう。

.BR syscalls (2)
マニュアルページにも、いろいろなシステムコールが初めて登場した
カーネルバージョンについての情報が書かれている。
.TP
.B 準拠 (CONFORMING TO)
そのマニュアルページで説明している関数やコマンドに関連する
標準規格や慣習について記載する。
セクション 2 や 3 のページでは、このセクションで
システムコールや関数が準拠する POSIX.1 のバージョンと、
C99 で規定されているかに触れるべきである。
(SUS, SUSv2, XPG などの他の標準規格や、SVr4 や 4.xBSD の実装標準に
ついては、説明しているコールがこれらの規格で規定されており
POSIX.1 の現行バージョンで規定されていない場合以外は、
あまり深く気にする必要はない。)
.RB ( standards (7)
参照。)

そのコールがどの標準にも基づいていないが、
他のシステムで広く存在する場合は、その旨を記載すること。
そのコールが Linux 固有の場合は、その旨を記載すること。

(そうなっているページが多いが) このセクションの内容が標準のリスト
だけの場合、リストの最後にピリオド (\(aq.\(aq) を置くこと。
.TP
.B 注意 (NOTES)
その他の注意点を書く。
セクション 2 と 3 のマニュアルページでは、
\fILinux での注意 (Linux Notes)\fP や \fIglibc での注意 (Glibc Notes)\fP
という名前のサブセクション (\fBSS\fP) を設けると便利なこともある。
.TP
.B バグ (BUGS)
制限・知られている欠陥や不便な点、その他不思議な動作などを書く。
.TP
.B 例 (EXAMPLE)
この関数・ファイル・コマンドをどのように使うかを示した
ひとつまたは複数の例を記述する。
サンプルプログラムを書く際の詳細は
以下の「サンプルプログラム」の節を参照のこと。
.TP
.B 著者 (AUTHORS)
文書またはプログラムの著者を列記する。
.B 著者セクションは極力使用しないこと。
一般的には、著者のリストを各ページに撒き散らさない方がよい
(時間がたつと、作者のリストは膨大になる可能性がある)。
マニュアルページを新規に書いたり、大幅に修正を行った場合には、
ソースファイルにコメントとして著作権表示を追加すること。
あなたがデバイスドライバの作者で、バグを報告するためのアドレスを
載せたい場合は、「バグ」セクションの後ろにこのセクションを配置すること。
.TP
.B 関連項目 (SEE ALSO)
関連するマニュアルページを、コンマ区切りのリストで、
セクション番号順に、セクション内ではアルファベット順で記載する。
可能なら関連する他の文書も書く。
慣習では、このセクションは最後に置く。
リストの末尾にピリオドを置かないこと。
.SS フォントの慣習
.PP
関数に対しては、引き数には常にイタリック体を用いる。
「たとえ書式 (SYNOPSIS) セクションであっても、このルールに従う」
関数の他の部分はボールドを指定する:
.PP
.BI "    int myfunction(int " argc ", char **" argv );
.PP
引き数名といった変数名はイタリック体を指定すべきである。
.PP
ファイル名 (パス名、または
.I /usr/include
ディレクトリ内のファイルへの参照) は常にイタリック体にする (例:
.IR <stdio.h> )。
ただし、書式 (SYNOPSIS) セクションは例外で、
インクルードファイルはボールドにする (例:
.BR "#include <stdio.h>" )。
.I /usr/include
以下の標準のインクルードファイルを参照する際は、
通常の C 言語と同様に山括弧でヘッダファイルを囲ぬで指定する (例：
.IR <stdio.h> )。
.PP
通常、大文字で表現する特殊マクロはボールドで表す (例えば
.BR MAXINT )。
例外として NULL はボールドにしない。
.PP
エラーコードのリストを列挙する時には、コードはボールドで表す
(このリストには通常
.B \&.TP
マクロを用いる)。
.PP
完全なコマンドは、長い場合には、例に示すように
字下げした行にコマンドだけを記載すべきである。
.in +4n
.nf

man 7 man-pages

.fi
.in
コマンドが短い場合は、
.I "man 7 man-pages"
のようにイタリック体で文中に埋め込んで記載してもよい。
この場合、コマンド内の適切な位置に、改行できないスペース ("\e\ ")
を使うとよいかもしれない。
コマンドオプションも
.I \-l
のようにイタリック体で記載すべきである。
.PP
式は、専用の字下げした行に記載しない場合、イタリック体を指定すること。
繰り返しになるが、式を通常の文中に埋め込む場合にも、
改行できないスペースを使うとよいだろう。
.PP
そのマニュアルページの説明対象への参照は、ボールドで名前を記載する。
対象が関数 (つまり、セクション 2 や 3 のページ) の場合、
名前の後ろにローマンフォント (通常のフォント) で丸括弧の対を続ける。
例えば、
.BR fcntl (2)
のマニュアルページでは、説明対象への参照は
.BR fcntl ()
のように記載する。
マニュアルページのソースファイルには次のように記載するのが望ましい:
.nf

    .BR fcntl ()

.fi
("\\fB...\\fP()" よりも、この形式を使うこと。
これにより、マニュアルページのソースファイルを解釈するツールを
書くのが簡単になる。)
.PP
別のマニュアルページへの参照は、ボールドで名前を記載し、
それに続けてセクション番号を「必ず」書く。セクション番号は
ローマンフォント (通常のフォント) で書き、スペースは入れない
(例:
.BR intro (2))。
マニュアルページのソースファイルには次のように記載するのが望ましい:
.nf

    .BR intro (2)

.fi
(相互参照にセクション番号を含めておくと、
.B man2html
といったツールがページ間のハイパーリンクを適切に生成できる。)
.SS 綴り (spelling)
リリース 2.59 からだが、
.I man-pages
はアメリカ英語の綴りの慣習に従っている。
新しいページやパッチは全てこの慣習に従って下さい。
.SS サンプルプログラムとシェルのセッション
マニュアルページには、システムコールやライブラリ関数の使い方を示す
サンプルプログラムを含めることができる。
その際には、以下の点に留意すべきである。
.TP 3
*
サンプルプログラムは C で記載すること。
.TP
*
サンプルプログラムは、
インタフェースについて文章で簡単に説明できる以上のことを示す場合にだけ
必要かつ有用である。インタフェースを呼び出す以外に何もしないサンプル
プログラムは普通はほとんど役に立たない。
.TP
*
サンプルプログラムはかなり短めにすること
(100行未満が望ましく、50行未満が理想的である)。
.TP
*
サンプルプログラムでは、システムコールやライブラリ関数を呼び出した後で
エラーチェックを行うこと。
.TP
*
サンプルプログラムは完結していて、
\fIcc\ \-Wall\fP
でコンパイルした際に警告なしでコンパイルできること。
.TP
*
可能かつ適切な場合には、サンプルプログラムで
入力により動作を変化させるなどの実験を行うとよい
(理想的には、コマンドライン引き数や、プログラムが読み込む入力データ
経由で、動作を変化させるのがよい)。
.TP
*
サンプルプログラムは、K&R (Kernighan and Ritchie) スタイルで書き、
字下げはスペース 4文字で行う。
(ソースコードで TAB 文字を使うのは避けること。)
.PP
サンプルプログラムがどんな風になっていればよいかの例については、
.BR wait (2)
と
.BR pipe (2)
を参照すること。

プログラムの使い方や他のシステムの特徴を示すためにシェルのセッション例
を含める場合、ユーザの入力文をボールドにして、システムが生成する
出力と区別できるようにすること。
.SS 構造体の定義、シェルのセッションログなどの字下げ
構造体の定義やシェルのセッションログなどを本文中に記載する際は、
スペース 4個分の字下げを行う (つまり、ブロックを
.I ".in\ +4n"
と
.I ".in"
で囲む)。
.SH 例
.I man-pages
パッケージに含まれるマニュアルページの体裁の標準的な例については、
.BR pipe (2)
と
.BR fcntl (2)
を参照すること。
.SH 関連項目
.BR man (1),
.BR man2html (1),
.BR groff (7),
.BR groff_man (7),
.BR man (7),
.BR mdoc (7)
